ν•Έλ“¤λ¬ λ§¤ν•‘κ³Ό ν•Έλ“¤λ¬ μ–΄λ‘ν„°
===========================
# π“ Controller μΈν„°νμ΄μ¤
> Controller μΈν„°νμ΄μ¤λ” @Controller μ• λ…Έν…μ΄μ…κ³Όλ” μ „ν€ λ‹¤λ¥΄λ‹¤.
   
κ³Όκ±° λ²„μ „ μ¤ν”„λ§ μ»¨νΈλ΅¤λ¬
```java  
org.springframework.web.servlet.mvc.Controller
```  
```java
@FunctionalInterface
public interface Controller {

	@Nullable
	ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) throws Exception;

}
```
μ¤ν”„λ§λ„ μ²μμ—λ” μ΄λ° λ”±λ”±ν• ν•μ‹μ μ»¨νΈλ΅¤λ¬λ¥Ό μ κ³µν–λ‹¤.
   
**Controller μΈν„°νμ΄μ¤ κµ¬ν„μ²΄**   
```java
// μ¤ν”„λ§ λΉ μ΄λ¦„μ„ URLμ— λ§μ¶”μ—λ‹¤.
@Component("/springmvc/old-controller")
public class OldController implements Controller {

    @Override
    public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) throws Exception {
        System.out.println("OldController.handleRequest");
        return null;
    }

}
```
* **@Component :** `/springmvc/old-controller` λΌλ” μ΄λ¦„μΌλ΅ **μ¤ν”„λ§ λΉ λ“±λ΅**   
* **λΉμ μ΄λ¦„μΌλ΅ URLμ„ λ§¤ν•‘ν•  κ²ƒμ΄λ‹¤.**   

**μ»¨νΈλ΅¤λ¬λ” μ–΄λ–»κ² νΈμ¶λ  μ μμ„κΉ? π¤”**   
   
![spring-mvc](https://user-images.githubusercontent.com/50267433/126873936-e90358e2-10ac-4b6e-9343-6d0c20c523fd.PNG)   
  
μ»¨νΈλ΅¤λ¬κ°€ νΈμ¶λλ ¤λ©΄ λ‹¤μ 2κ°€μ§€κ°€ ν•„μ”ν•λ‹¤.   
    
**β” HandlerMapping(ν•Έλ“¤λ¬ λ§¤ν•‘)**
* ν•Έλ“¤λ¬ λ§¤ν•‘μ—μ„ μ»¨νΈλ΅¤λ¬λ¥Ό μ°Ύμ„ μ μμ–΄μ•Ό ν•λ‹¤.
* **μ¤ν”„λ§ λΉμ μ΄λ¦„μΌλ΅ ν•Έλ“¤λ¬λ¥Ό μ°Ύμ„ μ μλ” ν•Έλ“¤λ¬ λ§¤ν•‘μ΄ ν•„μ”ν•λ‹¤.**    
     
**β” HandlerAdapter(ν•Έλ“¤λ¬ μ–΄λ‘ν„°)**  
* ν•Έλ“¤λ¬ λ§¤ν•‘μ„ ν†µν•΄μ„ μ°Ύμ€ ν•Έλ“¤λ¬λ¥Ό μ‹¤ν–‰ν•  μ μλ” ν•Έλ“¤λ¬ μ–΄λ‘ν„°κ°€ ν•„μ”ν•λ‹¤.   
* **Controller μΈν„°νμ΄μ¤λ¥Ό μ‹¤ν–‰ν•  μ μλ” ν•Έλ“¤λ¬ μ–΄λ‘ν„°λ¥Ό μ°Ύκ³  μ‹¤ν–‰ν•΄μ•Ό ν•λ‹¤.**   
   
μ¤ν”„λ§μ€ μ΄λ―Έ ν•„μ”ν• ν•Έλ“¤λ¬ λ§¤ν•‘κ³Ό ν•Έλ“¤λ¬ μ–΄λ‘ν„°λ¥Ό λ€λ¶€λ¶„ κµ¬ν„ν•΄λ‘μ—λ‹¤.   
κ°λ°μκ°€ μ§μ ‘ ν•Έλ“¤λ¬ λ§¤ν•‘κ³Ό ν•Έλ“¤λ¬ μ–΄λ‘ν„°λ¥Ό λ§λ“λ” μΌμ€ κ±°μ μ—†λ‹¤.   
  
## π“– ν•Έλ“¤λ¬ λ§¤ν•‘κ³Ό ν•Έλ“¤λ¬ μ–΄λ‘ν„° ν”„λ΅μ„Έμ¤    
μ¤ν”„λ§ λ¶€νΈκ°€ μλ™ λ“±λ΅ν•λ” ν•Έλ“¤λ¬ λ§¤ν•‘κ³Ό ν•Έλ“¤λ¬ μ–΄λ‘ν„°    
(μ‹¤μ λ΅λ” λ” λ§μ§€λ§, μ¤‘μ”ν• λ¶€λ¶„ μ„μ£Όλ΅ μ„¤λ…ν•κΈ° μ„ν•΄ μΌλ¶€ μƒλµ)

**HandlerMapping**
```java
0 = RequestMappingHandlerMapping   : μ• λ…Έν…μ΄μ… κΈ°λ°μ μ»¨νΈλ΅¤λ¬μΈ @RequestMappingμ—μ„ μ‚¬μ©
1 = BeanNameUrlHandlerMapping      : μ¤ν”„λ§ λΉμ μ΄λ¦„μΌλ΅ ν•Έλ“¤λ¬λ¥Ό μ°Ύλ”λ‹¤.
```
   
**HandlerAdapter**   
```java
0 = RequestMappingHandlerAdapter   : μ• λ…Έν…μ΄μ… κΈ°λ°μ μ»¨νΈλ΅¤λ¬μΈ @RequestMappingμ—μ„ μ‚¬μ©
1 = HttpRequestHandlerAdapter      : HttpRequestHandler μ²λ¦¬
2 = SimpleControllerHandlerAdapter : Controller μΈν„°νμ΄μ¤(μ• λ…Έν…μ΄μ…X, κ³Όκ±°μ— μ‚¬μ©) μ²λ¦¬
```
ν•Έλ“¤λ¬ λ§¤ν•‘λ„, ν•Έλ“¤λ¬ μ–΄λ‘ν„°λ„ λ¨λ‘ μμ„λ€λ΅ μ°Ύκ³  λ§μ•½ μ—†μΌλ©΄ λ‹¤μ μμ„λ΅ λ„μ–΄κ°„λ‹¤.      
urlμ„ κΈ°μ¤€μΌλ΅ `RequestMappingHandlerMapping`μ„ μ°Ύμ•λ”λ° μ—†κΈ°μ—     
λ‹¤μ μ°μ„  μμ„μΈ `BeanNameUrlHandlerMapping`μ—μ„ μ°Ύμ•„μ„ ν•Έλ“λ¬λ¥Ό κ°€μ Έμ™”λ κ²ƒμ΄λ‹¤.   
   
**1. ν•Έλ“¤λ¬ λ§¤ν•‘μΌλ΅ ν•Έλ“¤λ¬ μ΅°ν**  
1. `HandlerMapping` μ„ μμ„λ€λ΅ μ‹¤ν–‰ν•΄μ„ ν•Έλ“¤λ¬λ¥Ό μ°Ύλ”λ‹¤.       
2. μ΄ κ²½μ° λΉ μ΄λ¦„μΌλ΅ ν•Έλ“¤λ¬λ¥Ό μ°Ύμ•„μ•Ό ν•κΈ° λ•λ¬Έμ—         
   μ΄λ¦„ κ·Έλ€λ΅ λΉ μ΄λ¦„μΌλ΅ ν•Έλ“¤λ¬λ¥Ό μ°Ύμ•„μ£Όλ” `BeanNameUrlHandlerMapping` κ°€ μ‹¤ν–‰μ— μ„±κ³µν•κ³      
   ν•Έλ“¤λ¬μΈ `OldController` λ¥Ό λ°ν™ν•λ‹¤.     
   
**2. ν•Έλ“¤λ¬ μ–΄λ‘ν„° μ΅°ν**
1. `HandlerAdapter` μ `supports()` λ¥Ό μμ„λ€λ΅ νΈμ¶ν•λ‹¤.
2. `SimpleControllerHandlerAdapter` κ°€ Controller μΈν„°νμ΄μ¤λ¥Ό μ§€μ›ν•λ―€λ΅ λ€μƒμ΄ λλ‹¤.
   
**3. ν•Έλ“¤λ¬ μ–΄λ‘ν„° μ‹¤ν–‰**   
1. λ””μ¤ν¨μ² μ„λΈ”λ¦Ώμ΄ μ΅°νν• `SimpleControllerHandlerAdapter` λ¥Ό μ‹¤ν–‰ν•λ©΄μ„ ν•Έλ“¤λ¬ μ •λ³΄λ„ ν•¨κ» λ„κ²¨μ¤€λ‹¤.       
2. `SimpleControllerHandlerAdapter` λ” ν•Έλ“¤λ¬μΈ `OldController` λ¥Ό λ‚΄λ¶€μ—μ„ μ‹¤ν–‰ν•κ³ , κ·Έ κ²°κ³Όλ¥Ό λ°ν™ν•λ‹¤.    
      
**μ •λ¦¬ - OldController ν•Έλ“¤λ¬λ§¤ν•‘, μ–΄λ‘ν„°**         
OldController λ¥Ό μ‹¤ν–‰ν•λ©΄μ„ μ‚¬μ©λ κ°μ²΄λ” λ‹¤μκ³Ό κ°™λ‹¤.   
`HandlerMapping = BeanNameUrlHandlerMapping`    
`HandlerAdapter = SimpleControllerHandlerAdapter`    


