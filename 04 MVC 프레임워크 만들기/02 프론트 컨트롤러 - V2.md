02 í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ - V2   
=======================     
> View ê´€ë ¨ ë¡œì§ ë³„ë„ì˜ ê°ì²´ë¡œ ë¶„ë¦¬   
  
# ğŸ“˜ V2 êµ¬ì¡°
![v2](https://user-images.githubusercontent.com/50267433/126652138-455c048f-5377-4c3d-ba19-fb35ab93a5e9.PNG)   

V2 êµ¬ì¡°ëŠ” V1êµ¬ì¡°ì—ì„œ **Viewì™€ ê´€ë ¨ëœ ë¡œì§ì„ View ê°ì²´ë¡œ ë¶„ë¦¬ì‹œí‚¨ êµ¬ì¡°ë‹¤.**        

**ëª¨ë“  Controllerì—ì„œ ì •ì˜ëœ View ë¡œì§**
```java
String viewPath = "/WEB-INF/views/new-form.jsp";
RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
dispatcher.forward(request, response);
```   
ëª¨ë“  Controllerë“¤ì€ ë¡œì§ì„ ìˆ˜í–‰í•œ í›„ íŠ¹ì • Viewë¡œ íë¦„ì„ ì´ë™í•˜ê¸° ìœ„í•´ ìœ„ì™€ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤.          
ê·¸ëŸ¬ë‚˜ ìœ„ì™€ ê°™ì€ ì½”ë“œê°€ ëª¨ë“  Controllerì— ì¡´ì¬í•˜ê¸°ì— ì¤‘ë³µì´ ë°œìƒí•˜ê³  ì´ë¡œì¸í•´ ìœ ì§€ë³´ìˆ˜ì— ì–´ë ¤ì›€ì´ ìƒê²¼ë‹¤.     
(ê²½ë¡œë‚˜ í˜•ì‹ì´ ë°”ë€ë‹¤ë©´ ëª¨ë“  Controllerì˜ ì½”ë“œë¥¼ ì¼ì¼íˆ ìˆ˜ì •í•´ì¤˜ì•¼ í•œë‹¤ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤.)                 
    
ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´, **ë·° ê´€ë ¨ ë¡œì§ì„ `ë³„ë„ì˜ ê°ì²´`ë¡œ ë¶„ë¦¬í•˜ëŠ” ë°©ë²•ì„ ê³ ì•ˆí•´ëƒˆê³  ì´ë¥¼ í™œìš©í•œê²Œ V2ì´ë‹¤.**                 

## ğŸ“– FrontController
```java
@WebServlet(name = "frontControllerServletV2", urlPatterns = "/frontcontroller/v2/*")
public class FrontControllerServletV2 extends HttpServlet {
    
    private Map<String, ControllerV2> controllerMap = new HashMap<>();
    
    public FrontControllerServletV2() {
        controllerMap.put("/front-controller/v2/members/new-form", new MemberFormControllerV2());
        controllerMap.put("/front-controller/v2/members/save", new MemberSaveControllerV2());
        controllerMap.put("/front-controller/v2/members", new MemberListControllerV2());
    }
    
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String requestURI = request.getRequestURI();
        ControllerV2 controller = controllerMap.get(requestURI);
        if (controller == null) {
            response.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }
        MyView view = controller.process(request, response);
        view.render(request, response);
   }
}
```    
`FrontController`ëŠ” V1ê³¼ ë¹„êµí–ˆì„ ë•Œ ê·¸ë¦¬ í¬ê²Œ ë³€í•˜ì§€ëŠ” ì•Šì•˜ì§€ë§Œ           
`view.render(request, response);`ë¥¼ í†µí•´ ë°ì´í„° íë¦„ì„ ì´ë™ì‹œí‚¤ê³  ìˆë‹¤.       
ì¦‰, `MyView view` ê°ì²´ë¥¼ í™œìš©í•˜ì—¬ ì¤‘ë³µëœ ì½”ë“œë¥¼ ì¤„ì´ê³  ì—­í• ì„ ìœ„ì„í•˜ê¸°ë„ í–ˆë‹¤.     
 
## ğŸ“– View í´ë˜ìŠ¤ - View ê´€ë ¨ ë¡œì§ ë¶„ë¦¬
```java
public class MyView {
      
    private String viewPath;   
      
    public MyView(String viewPath) {
        this.viewPath = viewPath;
    }
      
    public void render(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
        dispatcher.forward(request, response);
    }
}
```
`MyView`í´ë˜ìŠ¤ëŠ” `View`ì™€ ê´€ë ¨ëœ ë¡œì§ë§Œì„ ìˆ˜í–‰í•˜ëŠ” ê°ì²´ë‹¤.                   
ì €ì¥í•˜ê³  ìˆëŠ” ê²½ë¡œë¥¼ í†µí•´ ë°ì´í„° íë¦„ì„ ë„˜ê¸°ëŠ” ì‘ì—…ì„ í•˜ê³  ìˆë‹¤.              
ì—¬ê¸°ì„œëŠ” êµ¬í˜„ì´ ë˜ì–´ìˆì§€ ì•Šì§€ë§Œ, ë•Œì— ë”°ë¼ `prefix`ì™€ `suffix`ë¥¼ ë¶„ë¦¬í•˜ì—¬ ê³µí†µìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.            
      
## ğŸ“– Controller ì¸í„°í˜ì´ìŠ¤  
```java
public interface ControllerV2 {
    MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException;
}
```
V1ê³¼ ë‹¬ë¦¬, `MyView`ë¥¼ ë¦¬í„´í•˜ë„ë¡ ì •ì˜ë˜ì–´ìˆë‹¤.   
     
## ğŸ“– Controller êµ¬í˜„ì²´ - íšŒì› ë“±ë¡ í¼   
```java
public class MemberFormControllerV2 implements ControllerV2 {
    @Override
    public MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        return new MyView("/WEB-INF/views/new-form.jsp");
    }
}
```  
`View`ì™€ ê´€ë ¨ëœ ë¡œì§ì€ ì´ë¯¸ `MyView`ì—ì„œ ì²˜ë¦¬í•˜ë¯€ë¡œ ê²½ë¡œë¥¼ ë„˜ê²¨ì£¼ì–´ ë°˜í™˜í•˜ëŠ” í˜•ì‹ìœ¼ë¡œ ì½”ë“œë¥¼ êµ¬ì„±í–ˆë‹¤.    

## ğŸ“– Controller êµ¬í˜„ì²´ - íšŒì› ì €ì¥

```java
public class MemberSaveControllerV2 implements ControllerV2 {
    
    private MemberRepository memberRepository = MemberRepository.getInstance();
    
    @Override
    public MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // ë°ì´í„° ì €ì¥
        String username = request.getParameter("username");
        int age = Integer.parseInt(request.getParameter("age"));
        Member member = new Member(username, age);
        memberRepository.save(member);
        
        // Modelì— ë°ì´í„° ë³´ê´€  
        request.setAttribute("member", member);
        
        // View ê²½ë¡œë¥¼ ì €ì¥í•˜ëŠ” MyView ë°˜í™˜ 
        return new MyView("/WEB-INF/views/save-result.jsp");
    }
}
```

## ğŸ“– Controller êµ¬í˜„ì²´ - íšŒì› ëª©ë¡ ì¡°íšŒ

```java
public class MemberListControllerV2 implements ControllerV2 {
    
    private MemberRepository memberRepository = MemberRepository.getInstance();
    
    @Override
    public MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // ë°ì´í„° ì¡°íšŒ 
        List<Member> members = memberRepository.findAll();
        
        // Modelì— ë°ì´í„° ë³´ê´€ 
        request.setAttribute("members", members);
        
        // View ê²½ë¡œë¥¼ ì €ì¥í•˜ëŠ” MyView ë°˜í™˜  
        return new MyView("/WEB-INF/views/members.jsp");
    }
}
```








