04 í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ - V4
======================
> ë‹¨ìˆœí•˜ê³  ì‹¤ìš©ì ì¸ ì»¨íŠ¸ë¡¤ëŸ¬   
       
V3 ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” **ì„œë¸”ë¦¿ ì¢…ì†ì„±ì„ ì œê±°**í•˜ê³  **ë·° ê²½ë¡œì˜ ì¤‘ë³µì„ ì œê±°**í•˜ëŠ” ë“± ì˜ ì„¤ê³„ëœ ì»¨íŠ¸ë¡¤ëŸ¬ë‹¤.             
ê·¸ëŸ¬ë‚˜ **í•­ìƒ ModelView ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ë°˜í™˜í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì¡°ê¸ˆ ê»„ë„ëŸ½ë‹¤.**             
     
ì¢‹ì€ í”„ë ˆì„ì›Œí¬ëŠ” ì•„í‚¤í…ì²˜ë„ ì¤‘ìš”í•˜ì§€ë§Œ, ê°œë°œìê°€ ë‹¨ìˆœí•˜ê³  í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í• ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.            
ì´ë²ˆì—ëŠ” v3ë¥¼ ì¡°ê¸ˆ ë³€í˜•í•´ì„œ ë§¤ìš° í¸ë¦¬í•˜ê²Œ ê°œë°œí•  ìˆ˜ ìˆëŠ” v4 ë²„ì „ì„ ê°œë°œí•´ë³´ì.        

# ğŸ“˜ V4 êµ¬ì¡° 
  
![v4](https://user-images.githubusercontent.com/50267433/126820122-89afe9fd-d26e-48bb-9248-afab6c1bae07.PNG)
  
ê¸°ì¡´ V3ì™€ ë§¤ìš° ë¹„ìŠ·í•œ êµ¬ì¡°ì´ì§€ë§Œ, **Controllerì—ê²Œ íŒŒë¼ë¯¸í„° ì •ë³´ëŠ” ë¬¼ë¡  ëª¨ë¸ ì •ë³´ê¹Œì§€ ë„˜ê¸´ë‹¤.**           
Controllerì—ì„œëŠ” **ëª¨ë¸ì— ì •ë³´ë¥¼ ë„£ê¸°ë§Œ í•´ë„ ê°ì²´ì´ë¯€ë¡œ ë°ì´í„°ê°€ ë°˜ì˜ì´ ë  ê²ƒì´ê³ **       
ë°˜í™˜í•˜ëŠ” ê°’ìœ¼ë¡œëŠ” **ë‹¨ìˆœ String íƒ€ì…ì˜ View ê²½ë¡œë§Œ ë„˜ê²¨ì£¼ë©´ ë  ê²ƒì´ë‹¤.**       

## 
```java
@WebServlet(name = "frontControllerServletV4", urlPatterns = "/front-controller/v4/*")
public class FrontControllerServletV4 extends HttpServlet {

    private Map<String, ControllerV4> controllerMap = new HashMap<>();

    public FrontControllerServletV4() {
        controllerMap.put("/front-controller/v4/members/new-form", new MemberFormControllerV4());
        controllerMap.put("/front-controller/v4/members/save", new MemberSaveControllerV4());
        controllerMap.put("/front-controller/v4/members", new MemberListControllerV4());
    }

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String requestURI = request.getRequestURI();
        ControllerV4 controller = controllerMap.get(requestURI);
        if (controller == null) {
            response.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }
        Map<String, String> paramMap = paramMap(request);
        Map<String, Object> model = new HashMap<>();
        String viewName = controller.process(paramMap, model);

        MyView myView = viewResolver(viewName);
        myView.render(model, request, response);
    }

    private Map<String, String> paramMap(HttpServletRequest request) {
        Map<String, String> paramMap = new HashMap<>();
        request.getParameterNames().asIterator()
                .forEachRemaining(paramName -> paramMap.put(paramName, request.getParameter(paramName)));
        return paramMap;
    }

    private MyView viewResolver(String viewName) {
        return new MyView("/WEB-INF/views/" + viewName + ".jsp");
    }
}
```


```java
public class MemberFormControllerV4 implements ControllerV4 {

    @Override
    public String process(Map<String, String> paramMap, Map<String, Object> model) {
        return "new-form";
    }
    
}
```

```java
public class MemberListControllerV4 implements ControllerV4 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public String process(Map<String, String> paramMap, Map<String, Object> model) {
        List<Member> members = memberRepository.findAll();
        model.put("members", members);
        return "members";
    }

}
```

```java
public class MemberSaveControllerV4 implements ControllerV4 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public String process(Map<String, String> paramMap, Map<String, Object> model) {
        String username = paramMap.get("username");
        int age = Integer.parseInt(paramMap.get("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);
        model.put("member", member);
        return "save-result";
    }

}
```
# ì •ë¦¬     
V4 ë²„ì „ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë§¤ìš° ë‹¨ìˆœí•˜ê³  ì‹¤ìš©ì ì´ë‹¤.     
ê¸°ì¡´ êµ¬ì¡°ì—ì„œ ëª¨ë¸ì„ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸°ê³ , ë·°ì˜ ë…¼ë¦¬ ì´ë¦„ì„ ë°˜í™˜í•œë‹¤ëŠ” ì‘ì€ ì•„ì´ë””ì–´ë¥¼ ì ìš©í–ˆì„ ë¿ì¸ë°,            
ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ êµ¬í˜„í•˜ëŠ” ê°œë°œì ì…ì¥ì—ì„œ ë³´ë©´ ì´ì œ êµ°ë”ë”ê¸° ì—†ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.          
